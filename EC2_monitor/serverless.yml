service: aws-ec2-monitor

frameworkVersion: '3'


provider:
  name: aws
  runtime: python3.9

functions:
  rateHandler:
    handler: handler.run
    environment:
      EMAIL_ADDRESSES: "email1@example.com,email2@example.com"
  CWevent:
    handler: handler.run
    #configure eventbridge to get treigered on start and terminate events 
    eevents:
      - cloudwatchEvent:
          name: "sre-ops-cw-ec2-alarm-rule"
          event:
            source:
              - 'aws.ec2'
            detail-type:
              - 'EC2 Instance State-change Notification'
            detail:
              state:
                - 'running'
                - 'terminated'